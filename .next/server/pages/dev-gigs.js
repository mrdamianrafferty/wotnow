"use strict";(()=>{var e={};e.id=472,e.ids=[220,472,636],e.modules={182:(e,t,a)=>{function s(e,t){if(null==t[function(e){let t=e.match(/^([a-zA-Z_]+)=(-?\d+(?:\.\d+)?)\.\.(-?\d+(?:\.\d+)?)/);if(t)return t[1];let a=e.match(/^([a-zA-Z_]+)[<>=!]=?/);return a?a[1]:e}(e)])return!0;let a=function(e){let t=e.match(/^([a-zA-Z_]+)=(-?\d+(?:\.\d+)?)\.\.(-?\d+(?:\.\d+)?)/);if(t)return{key:t[1],operator:"range",min:parseFloat(t[2]),max:parseFloat(t[3])};let a=e.match(/^([a-zA-Z_]+)([<>=!]=?|==)(-?\d+(?:\.\d+)?)/);return a?{key:a[1],operator:a[2],value:parseFloat(a[3])}:null}(e);if(!a)return!1;let s=t[a.key];if(null==s)return!1;if("range"===a.operator)return s>=a.min&&s<=a.max;switch(a.operator){case">":return s>a.value;case">=":return s>=a.value;case"<":return s<a.value;case"<=":return s<=a.value;case"=":case"==":return s===a.value;case"!=":return s!==a.value;default:return console.warn(`Unknown operator: ${a.operator}`),!1}}function n({forecast:e=[],interests:t=[],activities:a=[]}){return Array.isArray(a)&&Array.isArray(e)?e.map(e=>{let n=Array.isArray(e.marine)&&e.marine.length>0?e.marine[0]:{},r={...e.weather,...n},i=new Date(e.date).getMonth()+1,o=a.filter(e=>t.includes(e.id)&&(!e.seasonalMonths||e.seasonalMonths.includes(i))),l=[],c=[],d=[],u=[];for(let e of o){let{id:t,weatherSensitive:a,indoorAlternative:n}=e,i=function(e,t){return!1===e.weatherSensitive?"indoor":e.poorConditions?.some(e=>s(e,t))?"excluded":e.perfectConditions?.length&&e.perfectConditions.every(e=>s(e,t))?"perfect":e.goodConditions?.length&&e.goodConditions.every(e=>s(e,t))?"good":e.goodConditions&&0!==e.goodConditions.length||e.perfectConditions&&0!==e.perfectConditions.length?"excluded":"acceptable"}(e,r);"excluded"!==i&&("perfect"===i?l.push({activityId:t,evaluation:"perfect"}):"good"===i?c.push({activityId:t,evaluation:"good"}):"acceptable"===i?c.push({activityId:t,evaluation:"acceptable"}):"indoor"===i&&u.push({activityId:t,evaluation:"indoor"}),a&&n&&d.push(n))}let g=[],m=new Set;function v(e){for(let t of e)!m.has(t.activityId)&&g.length<10&&(m.add(t.activityId),g.push(t))}if(v(l),v(c),g.length<10&&d.length>0)for(let e of d){let t=a.find(t=>t.id===e||t.name===e);if(t&&!m.has(t.id)&&(g.push({activityId:t.id,evaluation:"indoorAlternative"}),m.add(t.id),g.length>=10))break}if(g.length<10){for(let e of u)if(!m.has(e.activityId)&&(g.push(e),m.add(e.activityId),g.length>=10))break}return{date:e.date,suggestions:g}}):[]}a.d(t,{p:()=>n})},237:(e,t)=>{Object.defineProperty(t,"A",{enumerable:!0,get:function(){return a}});var a=function(e){return e.PAGES="PAGES",e.PAGES_API="PAGES_API",e.APP_PAGE="APP_PAGE",e.APP_ROUTE="APP_ROUTE",e.IMAGE="IMAGE",e}({})},361:e=>{e.exports=require("next/dist/compiled/next-server/pages.runtime.prod.js")},1413:(e,t)=>{Object.defineProperty(t,"M",{enumerable:!0,get:function(){return function e(t,a){return a in t?t[a]:"then"in t&&"function"==typeof t.then?t.then(t=>e(t,a)):"function"==typeof t&&"default"===a?t:void 0}}})},2015:e=>{e.exports=require("react")},3022:(e,t,a)=>{a.r(t),a.d(t,{default:()=>i});var s=a(8732),n=a(2341),r=a.n(n);class i extends r(){render(){return(0,s.jsxs)(n.Html,{children:[(0,s.jsx)(n.Head,{}),(0,s.jsxs)("body",{children:[(0,s.jsx)(n.Main,{}),(0,s.jsx)(n.NextScript,{})]})]})}}},3873:e=>{e.exports=require("path")},8416:(e,t,a)=>{a.r(t),a.d(t,{config:()=>b,default:()=>h,getServerSideProps:()=>y,getStaticPaths:()=>_,getStaticProps:()=>f,reportWebVitals:()=>x,routeModule:()=>N,unstable_getServerProps:()=>w,unstable_getServerSideProps:()=>A,unstable_getStaticParams:()=>P,unstable_getStaticPaths:()=>S,unstable_getStaticProps:()=>j});var s={};a.r(s),a.d(s,{default:()=>p});var n=a(3885),r=a(237),i=a(1413),o=a(3022),l=a(8198),c=a(8732),d=a(2015),u=a(2165),g=a(182),m=a(3136);let v={live_music:{label:"Live Music",category:103,format:6},music_festivals:{label:"Music Festivals",category:103,format:7},dj_dance:{label:"DJ / Dance Events",category:103,format:5,keywords:"DJ OR dance OR club"},local_music:{label:"Local Music Scene",category:103,format:6,radius:"25km"},theatre_performance:{label:"Theatre & Performance",category:105,keywords:"theatre OR play OR drama"},comedy_entertainment:{label:"Comedy & Entertainment",category:105,format:5,keywords:"comedy OR stand-up OR improv"},art_exhibitions:{label:"Art Exhibitions",category:105,keywords:"exhibition OR gallery"},dance_movement:{label:"Dance & Movement",category:105,format:6,keywords:"dance OR ballet OR contemporary"},film_media:{label:"Film & Media",category:104,format:9},competitive_sports:{label:"Competitive Sports",category:108,format:12},fitness_wellness:{label:"Fitness & Wellness",category:107,format:11},running_cycling:{label:"Running & Cycling",category:108,format:12,keywords:"run OR cycle OR marathon"},outdoor_adventures:{label:"Outdoor Adventures",category:109,format:11},team_sports_social:{label:"Team Sports Social",category:108,format:4,keywords:"football OR basketball OR volleyball"}};function p(){let{preferences:e,setPreferences:t}=(0,u.HW)(),a=e.location,s=e.interests||[],n=a?.name||"Berlin",[r,i]=(0,d.useState)(n),[o,l]=(0,d.useState)([]),[p,h]=(0,d.useState)({}),[f,_]=(0,d.useState)(!1),[y,b]=(0,d.useState)(!1),x=[...e.eventPreferences?.musicCategories??[],...e.eventPreferences?.artsCategories??[],...e.eventPreferences?.sportsCategories??[]];async function j(e){e.preventDefault();try{let e=`https://api.openweathermap.org/geo/1.0/direct?q=${encodeURIComponent(r)}&limit=1&appid=748bd0822b74e58605964652c38d0796`,a=await fetch(e).then(e=>e.json());if(a[0]){let{lat:e,lon:s,country:n}=a[0];t(t=>({...t,location:{name:r,lat:e,lon:s,countryCode:n}}))}}catch(e){}}(0,d.useEffect)(()=>{!async function(){if(!n||0===x.length)return;_(!0);let e={};for(let t of x){let a=v[t];if(!a)continue;let s=new URLSearchParams({city:n,category:String(a.category)});a.format&&s.set("format",String(a.format)),a.keywords&&s.set("keywords",a.keywords),s.set("radius",a.radius||"100km");try{let a=await fetch(`/api/events?${s.toString()}`),n=await a.json();Array.isArray(n.events)?e[t]=n.events:e[t]=[]}catch(a){e[t]=[]}}h(e),_(!1)}()},[n,x.join(",")]);let S=o.map(e=>{let t={temperature:e.temp,precipitation:e.rain,windSpeed:e.windSpeed,water_temp:null,clouds:e.clouds},a=(0,g.p)({forecast:[{date:e.date,weather:t}],interests:s,activities:m.b});return{date:e.date,emoji:function(e=""){let t=e.toLowerCase();return t.includes("sun")||"clear"===t?"☀️":t.includes("rain")?"\uD83C\uDF27️":t.includes("snow")?"❄️":t.includes("cloud")?"☁️":t.includes("thunderstorm")?"⛈️":"\uD83C\uDF24️"}(e.condition),description:e.condition,suggestions:a[0]?.suggestions||[]}});return y?(0,c.jsxs)("main",{className:"devgigs",children:[(0,c.jsx)("h1",{className:"devgigs__title",children:"WotNow: Suggestions & Upcoming Events"}),(0,c.jsxs)("section",{className:"devgigs__section devgigs__section--location",children:[(0,c.jsx)("h2",{children:"Location"}),(0,c.jsxs)("form",{className:"devgigs__location-form",onSubmit:j,children:[(0,c.jsx)("input",{className:"devgigs__location-input",value:r,onChange:e=>i(e.target.value),placeholder:"Enter city or town"}),(0,c.jsx)("button",{className:"devgigs__location-btn",type:"submit",children:"Save"})]})]}),(0,c.jsxs)("section",{className:"devgigs__section devgigs__section--forecast",children:[(0,c.jsx)("h2",{children:"Suggestions by Day"}),(0,c.jsx)("ul",{className:"devgigs__forecast-list",children:S.map(({date:e,emoji:t,description:a,suggestions:s})=>(0,c.jsxs)("li",{className:"devgigs__forecast-item",children:[(0,c.jsxs)("span",{className:"devgigs__forecast-date",children:[(0,c.jsx)("strong",{children:e})," – ",t," ",a]}),s.length>0?(0,c.jsx)("ul",{className:"devgigs__activity-list",children:s.map(e=>{let t=m.b.find(t=>t.id===e.activityId);return(0,c.jsxs)("li",{className:"devgigs__activity-item",children:[t?.name||e.activityId," ",(0,c.jsxs)("span",{className:"devgigs__activity-eval",children:["(",e.evaluation,")"]})]},e.activityId)})}):(0,c.jsx)("span",{className:"devgigs__forecast-none",children:"No suggestions for this day."})]},e))})]}),(0,c.jsxs)("section",{className:"devgigs__section devgigs__section--events",children:[(0,c.jsx)("h2",{children:"Events You Might Enjoy"}),0===x.length&&(0,c.jsxs)("p",{className:"devgigs__no-categories",children:["You haven't selected any event categories in your preferences. Head to the ",(0,c.jsx)("strong",{children:"Interests"})," page to pick some!"]}),!f&&0===Object.values(p).flat().length&&x.length>0&&(0,c.jsx)("p",{className:"devgigs__no-events",children:"✅ No upcoming events found for your selected categories. Adjust preferences or check again later."}),(0,c.jsx)("div",{className:"devgigs__events-group",children:x.map(e=>{let t=v[e],a=p[e];return t?(0,c.jsxs)("div",{className:"devgigs__category",children:[(0,c.jsx)("h3",{className:"devgigs__category-label",children:t.label}),f?(0,c.jsx)("p",{className:"devgigs__loading",children:"Fetching events…"}):a&&0!==a.length?(0,c.jsx)("ul",{className:"devgigs__events-list",children:a.map(e=>(0,c.jsxs)("li",{className:"devgigs__event-card",children:[(0,c.jsx)("strong",{className:"devgigs__event-title",children:e.name}),(0,c.jsx)("br",{}),(0,c.jsxs)("span",{className:"devgigs__event-details",children:[new Date(e.date).toLocaleString()," at"," ",(0,c.jsx)("a",{href:`https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(e.venue+", "+e.city)}`,target:"_blank",rel:"noopener noreferrer",className:"devgigs__event-venue-link",children:e.venue})]}),(0,c.jsx)("br",{}),(0,c.jsx)("a",{href:e.url,target:"_blank",rel:"noopener noreferrer",className:"devgigs__event-link",children:"Event details →"})]},e.id))}):(0,c.jsx)("p",{className:"devgigs__no-events-category",children:"No events found in this category."})]},e):null})})]})]}):null}let h=(0,i.M)(s,"default"),f=(0,i.M)(s,"getStaticProps"),_=(0,i.M)(s,"getStaticPaths"),y=(0,i.M)(s,"getServerSideProps"),b=(0,i.M)(s,"config"),x=(0,i.M)(s,"reportWebVitals"),j=(0,i.M)(s,"unstable_getStaticProps"),S=(0,i.M)(s,"unstable_getStaticPaths"),P=(0,i.M)(s,"unstable_getStaticParams"),w=(0,i.M)(s,"unstable_getServerProps"),A=(0,i.M)(s,"unstable_getServerSideProps"),N=new n.PagesRouteModule({definition:{kind:r.A.PAGES,page:"/dev-gigs",pathname:"/dev-gigs",bundlePath:"",filename:""},components:{App:l.default,Document:o.default},userland:s})},8732:e=>{e.exports=require("react/jsx-runtime")}};var t=require("../webpack-runtime.js");t.C(e);var a=e=>t(t.s=e),s=t.X(0,[300,341,918,198],()=>a(8416));module.exports=s})();