(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[196],{6556:(e,t,n)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/weather",function(){return n(6665)}])},6665:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>s});var i=n(7876),r=n(4232),a=n(3974);let s=()=>{let{preferences:e}=(0,a.HW)(),{location:t}=e,[n,s]=(0,r.useState)([]),[l,d]=(0,r.useState)(!0),[c,o]=(0,r.useState)(""),[u,h]=(0,r.useState)({}),[m,p]=(0,r.useState)(""),[w,f]=(0,r.useState)(""),j="748bd0822b74e58605964652c38d0796";if((0,r.useEffect)(()=>{if(!t||!t.lat||!t.lon){o("Location not set in preferences."),d(!1);return}if(!j){o("OpenWeather API key is not configured."),d(!1);return}(async()=>{try{let e=await fetch("https://api.openweathermap.org/data/2.5/forecast?lat=".concat(t.lat,"&lon=").concat(t.lon,"&units=metric&appid=").concat(j));if(!e.ok)throw Error("Failed to fetch forecast");let n=await e.json(),i=new Date().toISOString().split("T")[0],r=n.list.map(e=>{var t,n,i,r,a,s,l,d,c,o,u,h,m,p;let[w,f]=e.dt_txt.split(" ");return{date:w,time:f.slice(0,5),temp:Math.round(e.main.temp),description:null!=(d=null==(n=e.weather)||null==(t=n[0])?void 0:t.description)?d:"",precipitation:null!=(o=null!=(c=null==(i=e.rain)?void 0:i["3h"])?c:null==(r=e.snow)?void 0:r["3h"])?o:0,wind:null!=(u=null==(a=e.wind)?void 0:a.speed)?u:0,humidity:null!=(h=null==(s=e.main)?void 0:s.humidity)?h:0,clouds:null!=(m=null==(l=e.clouds)?void 0:l.all)?m:0,visibility:(null!=(p=e.visibility)?p:1e4)/1e3}}),a={};a[i]=!0,h(a),s(r);let l=await fetch("https://api.openweathermap.org/data/2.5/weather?lat=".concat(t.lat,"&lon=").concat(t.lon,"&units=metric&appid=").concat(j));if(!l.ok)throw Error("Failed to fetch weather data");let d=await l.json(),c=new Date(1e3*d.sys.sunrise),o=new Date(1e3*d.sys.sunset);p(c.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit"})),f(o.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit"}))}catch(e){o(e.message)}finally{d(!1)}})()},[t,j]),l)return(0,i.jsx)("div",{children:"Loading forecast..."});if(c)return(0,i.jsx)("div",{style:{color:"red"},children:c});let x=(e,t)=>{let n=e.toLowerCase(),i=(()=>{if(!t)return!1;let[e]=t.split(":"),n=parseInt(e,10);return n<6||n>=20})();return n.includes("rain")||n.includes("shower")?"\uD83C\uDF27️":n.includes("storm")||n.includes("thunder")?"⛈️":n.includes("snow")||n.includes("sleet")||n.includes("flurr")?"❄️":n.includes("clear")||n.includes("sun")?i?"\uD83C\uDF19":"☀️":n.includes("cloud")?"☁️":i?"\uD83C\uDF19":"☀️"},D=e=>{h(t=>({...t,[e]:!t[e]}))},g=n.reduce((e,t)=>(e[t.date]||(e[t.date]=[]),e[t.date].push(t),e),{}),y=e=>{let t=new Date(e),n=new Date,i=new Date;return(i.setDate(n.getDate()+1),t.toDateString()===n.toDateString())?"Today":t.toDateString()===i.toDateString()?"Tomorrow":new Intl.DateTimeFormat("en-US",{weekday:"long"}).format(t)};return(0,i.jsxs)("div",{className:"container",style:{paddingLeft:"1rem"},children:[(0,i.jsxs)("h1",{children:["5-Day Detailed Forecast for ",t.name.charAt(0).toUpperCase()+t.name.slice(1)]}),(0,i.jsxs)("table",{className:"weather-table spaced",children:[(0,i.jsx)("thead",{children:(0,i.jsxs)("tr",{children:[(0,i.jsx)("th",{children:"Time"}),(0,i.jsx)("th",{children:"\uD83C\uDF21️ Temp"}),(0,i.jsx)("th",{children:"Weather"}),(0,i.jsx)("th",{children:"☔ Precip"}),(0,i.jsx)("th",{children:"\uD83D\uDCA8 Wind"}),(0,i.jsx)("th",{children:"\uD83D\uDCA7 Humidity"}),(0,i.jsx)("th",{children:"☁️ Clouds"}),(0,i.jsx)("th",{children:"\uD83D\uDD0D Visibility"})]})}),(0,i.jsx)("tbody",{children:Object.entries(g).map(e=>{let[t,n]=e;return(0,i.jsxs)(r.Fragment,{children:[(0,i.jsx)("tr",{className:"day-header",onClick:()=>D(t),children:(0,i.jsxs)("td",{colSpan:8,style:{cursor:"pointer",background:"#f0f0f0"},children:[(0,i.jsxs)("span",{style:{fontWeight:"bold"},children:[u[t]?"▼":"▶"," ",y(t)]}),"Today"===y(t)&&m&&w?" (Sunrise at ".concat(m," and Sunset at ").concat(w,")"):""]})}),u[t]&&n.map(e=>(0,i.jsxs)("tr",{children:[(0,i.jsx)("td",{children:(()=>{let t=new Date("".concat(e.date,"T").concat(e.time)),n=t.getHours();return(t.getMinutes().toString().padStart(2,"0"),0===n)?"Midnight":12===n?"Noon":t.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit"})})()}),(0,i.jsxs)("td",{className:e.temp>25?"hot":e.temp<5?"cold":"",children:[e.temp,"\xb0C"]}),(0,i.jsx)("td",{style:{fontSize:"1.2rem"},children:x(e.description,e.time)}),(0,i.jsxs)("td",{children:[e.precipitation," mm"]}),(0,i.jsxs)("td",{className:e.wind>15?"windy":"",children:[(3.6*e.wind).toFixed(1)," km/h"]}),(0,i.jsxs)("td",{children:[e.humidity,"%"]}),(0,i.jsxs)("td",{children:[e.clouds,"%"]}),(0,i.jsxs)("td",{children:[e.visibility," km"]})]},"".concat(e.date,"-").concat(e.time)))]},t)})})]})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[636,593,792],()=>t(6556)),_N_E=e.O()}]);